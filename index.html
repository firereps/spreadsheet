<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FireReps Spreadsheet - Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet" />
  <style id="page-styles">
    /* twoje style... */
    body { /* … */ }
    header { /* … */ }
    .main-title { /* … */ }
    #login-btn { /* … */ }
    #item-container { /* … */ }
    .item-card { /* … */ }
    .item-card img { /* … */ }
    .card-content { /* … */ }
    .buy-btn { /* … */ }
    .delete-btn { /* … */ }
    body.admin-view .delete-btn { display: block; }
    .add-card { /* … */ }
    .modal { /* … */ }
    .modal-content { /* … */ }
  </style>
</head>
<body>
  <header>
    <h1 class="main-title">FireReps Spreadsheet</h1>
    <button id="login-btn">Zaloguj</button>
  </header>

  <main id="item-container"></main>

  <div class="add-card" id="add-card" style="display:none;cursor:pointer;margin:20px">
    <div style="font-size:48px">+</div>
    <div>dodaj produkt</div>
  </div>

  <!-- modal dodawania -->
  <div id="add-modal" class="modal">
    <div class="modal-content">
      <h2>Dodaj nowy produkt</h2>
      <input type="text" id="item-name" placeholder="nazwa" />
      <textarea id="item-desc" placeholder="opis"></textarea>
      <input type="text" id="item-link" placeholder="link (opcjonalnie)" />
      <input type="text" id="item-image-url" placeholder="url do zdjecia" />
      <div style="text-align:right">
        <button id="cancel-add" class="btn-cancel">anuluj</button>
        <button id="confirm-add" class="btn-add">dodaj</button>
      </div>
    </div>
  </div>

  <!-- modal potwierdzenia -->
  <div id="delete-modal" class="modal">
    <div class="modal-content">
      <p>Czy na pewno chcesz usunąć ten produkt?</p>
      <div style="text-align:right">
        <button id="cancel-delete" class="btn-cancel">nie</button>
        <button id="confirm-delete" class="btn-delete-confirm">tak</button>
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js"></script>
  <script>
    // tu podstaw swoje dane z Firebase:
    const firebaseConfig = {
      apiKey: "AIzaSyB7tQvTVeG-WlBcvTByiKW7GfPpD52vDGw",
      authDomain: "spridszit-firerepy.firebaseapp.com",
      databaseURL: "https://spridszit-firerepy-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "spridszit-firerepy",
      storageBucket: "spridszit-firerepy.appspot.com",
      messagingSenderId: "963006920352",
      appId: "1:963006920352:web:58538b879f004c02873bc5"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const itemsRef = db.ref('items');

    const loginBtn = document.getElementById('login-btn'),
          addCard = document.getElementById('add-card'),
          addModal = document.getElementById('add-modal'),
          deleteModal = document.getElementById('delete-modal'),
          cancelAdd = document.getElementById('cancel-add'),
          confirmAdd = document.getElementById('confirm-add'),
          cancelDelete = document.getElementById('cancel-delete'),
          confirmDelete = document.getElementById('confirm-delete'),
          container = document.getElementById('item-container');

    let isAdmin = false, deleteKey = null;

    function showModal(m){ m.style.display='flex'; document.body.style.filter='blur(3px)'; }
    function hideModal(m){ m.style.display='none'; document.body.style.filter='none'; }
    function renderItems(){
      container.innerHTML = '';
      itemsRef.once('value', snap => {
        snap.forEach(ch => {
          const it = ch.val(), key = ch.key;
          const card = document.createElement('div');
          card.className = 'item-card';
          card.innerHTML = `
            <img src="${it.image}" alt="${it.name}">
            <div class="card-content">
              <h3>${it.name}</h3>
              <p>${it.description||''}</p>
              ${it.link?`<a class="buy-btn" href="${it.link}" target="_blank">kup</a>`:''}
            </div>`;
          if(isAdmin){
            const btn = document.createElement('button');
            btn.className = 'delete-btn';
            btn.textContent = 'usuń';
            btn.onclick = () => { deleteKey = key; showModal(deleteModal); };
            card.appendChild(btn);
          }
          container.appendChild(card);
        });
        if(isAdmin) addCard.style.display = 'block'; else addCard.style.display = 'none';
      });
    }

    loginBtn.onclick = () => {
      if(!isAdmin){
        const l = prompt('login'), p = prompt('haslo');
        if(l==='ifirelovereps' && p==='fi123re987re098ps321'){
          isAdmin = true;
          loginBtn.textContent = 'wyloguj';
        } else {
          alert('bledne dane');
          return;
        }
      } else {
        isAdmin = false;
        loginBtn.textContent = 'zaloguj';
      }
      renderItems();
    };

    addCard.onclick = () => { showModal(addModal); };

    cancelAdd.onclick = () => { hideModal(addModal); };
    confirmAdd.onclick = () => {
      const n = document.getElementById('item-name').value.trim(),
            d = document.getElementById('item-desc').value.trim(),
            l = document.getElementById('item-link').value.trim(),
            u = document.getElementById('item-image-url').value.trim();
      if(!n || !u){ alert('wypelnij nazwe i url'); return; }
      itemsRef.push({ name: n, description: d, link: l, image: u }, err => {
        if(err) alert('blad zapisu');
        else {
          hideModal(addModal);
          renderItems();
        }
      });
    };

    cancelDelete.onclick = () => { deleteKey = null; hideModal(deleteModal); };
    confirmDelete.onclick = () => {
      if(deleteKey){
        itemsRef.child(deleteKey).remove(err => {
          if(err) alert('blad usuniecia');
          else { deleteKey = null; hideModal(deleteModal); renderItems(); }
        });
      }
    };

    renderItems();
  </script>
</body>
</html>
