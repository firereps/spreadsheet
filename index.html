<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FireReps Spreadsheet</title>
<style>
  /* ogolny styl */
  body {
    margin: 0;
    background: #0d1117;
    font-family: 'Arial Black', Arial, sans-serif;
    color: #c9d1d9;
  }

  /* header z napisem zamiast logo */
  header {
    background: #161b22;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 900;
    font-size: 22px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    user-select: none;
    border-bottom: 1px solid #30363d;
  }

  /* przycisk zaloguj sie */
  #login-button {
    position: fixed;
    top: 12px;
    right: 15px;
    background: #238636;
    border: none;
    color: #c9d1d9;
    font-weight: 700;
    font-size: 14px;
    padding: 10px 20px;
    border-radius: 15px;
    cursor: pointer;
    user-select: none;
    transition: background 0.3s ease;
    z-index: 1000;
  }
  #login-button:hover {
    background: #2ea043;
  }

  #logout-button {
    position: fixed;
    top: 12px;
    right: 15px;
    background: #8b0000;
    border: none;
    color: #fff;
    font-weight: 700;
    font-size: 14px;
    padding: 10px 20px;
    border-radius: 15px;
    cursor: pointer;
    user-select: none;
    display: none;
    z-index: 1000;
  }
  #logout-button:hover {
    background: #a00b0b;
  }

  /* kontener na itemy - flex, grid styl */
  #items-container {
    max-width: 1200px;
    margin: 60px auto 40px;
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(210px,1fr));
    gap: 18px;
    padding: 0 15px;
  }

  /* pojedynczy item card */
  .item-card {
    background: #161b22;
    border-radius: 15px;
    box-shadow: 0 0 12px #238636aa;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    user-select: none;
    transition: box-shadow 0.3s ease;
  }
  .item-card:hover {
    box-shadow: 0 0 20px #2ea043cc;
  }

  /* obrazek w item */
  .item-card img {
    width: 100%;
    aspect-ratio: 1 / 1;
    object-fit: contain;
    background: #0d1117;
    padding: 10px;
  }

  /* tekst nazwy itemu */
  .item-title {
    font-weight: 800;
    font-size: 18px;
    padding: 8px 15px 0 15px;
    min-height: 48px;
    color: #c9d1d9;
  }

  /* cena pod nazwa */
  .item-price {
    font-weight: 700;
    font-size: 16px;
    padding: 2px 15px 10px 15px;
    color: #238636;
  }

</style>
</head>
<body>

<header>FireReps Spreadsheet</header>

<button id="login-button">Zaloguj sie</button>
<button id="logout-button">Wyloguj sie</button>

<div id="items-container"></div>

<!-- modal logowania -->
<div id="login-modal" style="display:none; position:fixed; z-index:1100; inset:0; background:rgba(0,0,0,0.75); display:flex; justify-content:center; align-items:center;">
  <div style="background:#161b22; padding:25px 30px; border-radius: 12px; width:320px; box-shadow: 0 0 20px #238636cc;">
    <h2 style="color:#c9d1d9; font-weight: 900; font-size: 24px; margin:0 0 15px 0; text-align:center;">Logowanie Admin</h2>
    <input id="login-username" type="text" placeholder="Nazwa uzytkownika" style="width:100%; margin-bottom:12px; padding:10px; border-radius:8px; border:none; font-size:16px;" />
    <input id="login-password" type="password" placeholder="Haslo" style="width:100%; margin-bottom:15px; padding:10px; border-radius:8px; border:none; font-size:16px;" />
    <button id="login-submit" style="width:100%; background:#238636; border:none; padding:12px; border-radius:12px; font-weight:700; color:#c9d1d9; cursor:pointer; font-size:18px;">Zaloguj</button>
  </div>
</div>

<script type="module">
// firebase config i init
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyB7tQvTVeG-WlBcvTByiKW7GfPpD52vDGw",
  authDomain: "spridszit-firerepy.firebaseapp.com",
  databaseURL: "https://spridszit-firerepy-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "spridszit-firerepy",
  storageBucket: "spridszit-firerepy.firebasestorage.app",
  messagingSenderId: "963006920352",
  appId: "1:963006920352:web:58538b879f004c02873bc5"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const loginButton = document.getElementById("login-button");
const logoutButton = document.getElementById("logout-button");
const loginModal = document.getElementById("login-modal");
const loginSubmit = document.getElementById("login-submit");
const loginUsername = document.getElementById("login-username");
const loginPassword = document.getElementById("login-password");
const itemsContainer = document.getElementById("items-container");

const ADMIN_USER = "ifirelovereps";
const ADMIN_PASS = "fi123re987re098ps321";

let isAdmin = false;

function showLoginModal() {
  loginModal.style.display = "flex";
  loginUsername.value = "";
  loginPassword.value = "";
  loginUsername.focus();
}
function hideLoginModal() {
  loginModal.style.display = "none";
}

function updateUIForAdmin() {
  loginButton.style.display = "none";
  logoutButton.style.display = "block";
}
function updateUIForGuest() {
  loginButton.style.display = "block";
  logoutButton.style.display = "none";
}

function renderItems(items) {
  itemsContainer.innerHTML = "";
  for(const key in items) {
    const item = items[key];
    const card = document.createElement("div");
    card.className = "item-card";

    if(item.image) {
      const img = document.createElement("img");
      img.src = item.image;
      img.alt = item.name;
      card.appendChild(img);
    }

    const title = document.createElement("div");
    title.className = "item-title";
    title.textContent = item.name;
    card.appendChild(title);

    if(item.price) {
      const price = document.createElement("div");
      price.className = "item-price";
      price.textContent = item.price + " PLN";
      card.appendChild(price);
    } else if(item.description) {
      const desc = document.createElement("div");
      desc.className = "item-price";
      desc.style.color = "#8b949e";
      desc.textContent = item.description;
      card.appendChild(desc);
    }

    itemsContainer.appendChild(card);
  }
}

function fetchAndRenderItems() {
  const itemsRef = ref(db, "items");
  onValue(itemsRef, (snapshot) => {
    const data = snapshot.val() || {};
    renderItems(data);
  });
}

loginButton.onclick = () => {
  showLoginModal();
};

logoutButton.onclick = () => {
  isAdmin = false;
  updateUIForGuest();
  fetchAndRenderItems();
};

loginSubmit.onclick = () => {
  const user = loginUsername.value.trim();
  const pass = loginPassword.value.trim();
  if(user === ADMIN_USER && pass === ADMIN_PASS) {
    isAdmin = true;
    hideLoginModal();
    updateUIForAdmin();
    fetchAndRenderItems();
  } else {
    alert("niepoprawny login lub haslo");
  }
};

loginModal.onclick = (e) => {
  if(e.target === loginModal) hideLoginModal();
};

updateUIForGuest();
fetchAndRenderItems();

</script>

</body>
</html>
