<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FireReps Spreadsheet - Panel</title>
<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    background-color: #f0f2f5;
    color: #1c1e21;
}
header {
    background-color: #fff;
    padding: 10px 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 100;
}
.main-title {
    font-family: 'Poppins', sans-serif;
    font-size: 24px;
    font-weight: 500;
    color: #1c1e21;
    margin: 0;
}
#login-form {
    display: flex;
    gap: 10px;
    align-items: center;
}
#login-form input[type="text"],
#login-form input[type="password"] {
    padding: 6px 10px;
    font-size: 14px;
    border: 1px solid #ccc;
    border-radius: 6px;
}
#login-form button {
    padding: 6px 14px;
    font-size: 14px;
    font-weight: 600;
    border-radius: 6px;
    border: none;
    background-color: #1877f2;
    color: white;
    cursor: pointer;
}
#login-form button:hover {
    background-color: #166fe5;
}
#logout-btn {
    display: none;
    padding: 6px 14px;
    font-size: 14px;
    font-weight: 600;
    border-radius: 6px;
    border: none;
    background-color: #e74c3c;
    color: white;
    cursor: pointer;
}
#logout-btn.show {
    display: inline-block;
}
#item-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    padding: 40px 20px;
}
.item-card {
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    width: 300px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    position: relative;
}
.item-card img {
    width: 100%;
    height: 200px;
    object-fit: cover;
}
.card-content {
    padding: 15px;
    display: flex;
    flex-direction: column;
    flex-grow: 1;
}
.card-content h3 {
    margin: 0 0 10px 0;
    font-size: 20px;
    color: #1c1e21;
}
.card-content p {
    margin: 0 0 15px 0;
    font-size: 14px;
    color: #606770;
    flex-grow: 1;
}
.buy-btn {
    display: block;
    width: 100%;
    padding: 10px 0;
    text-align: center;
    background-color: #42b72a;
    color: white;
    text-decoration: none;
    font-weight: 600;
    border-radius: 6px;
    margin-top: auto;
    transition: background-color 0.2s;
}
.buy-btn:hover { background-color: #36a420; }
.delete-btn {
    position: absolute;
    bottom: 50px;
    width: 90%;
    margin: 0 5%;
    padding: 10px 0;
    background-color: #e74c3c;
    color: white;
    font-weight: 600;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s;
    display: none;
}
.delete-btn.show { display: block; }
.add-card {
    cursor: pointer;
    border: 2px dashed #a0a0a0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #606770;
    background-color: #f7f8fa;
    width: 300px;
    height: 300px;
    border-radius: 8px;
    transition: background-color 0.2s, border-color 0.2s;
    display: none;
}
.add-card.show {
    display: flex;
}
.add-card:hover {
    background-color: #e0e2e5;
    border-color: #1877f2;
    color: #1877f2;
}
.plus-icon {
    font-size: 80px;
    font-weight: lighter;
    line-height: 1;
    user-select: none;
}
.add-card h3 {
    margin-top: 10px;
    font-weight: 600;
    font-size: 20px;
}
.modal {
    display: none;
    position: fixed;
    z-index: 200;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.5);
    align-items: center;
    justify-content: center;
}
.modal.show {
    display: flex;
}
.modal-content {
    background-color: #fff;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    width: 90%;
    max-width: 500px;
    position: relative;
    display: flex;
    flex-direction: column;
}
.modal-content h2 {
    margin: 0 0 20px 0;
    font-weight: 700;
    font-size: 24px;
    color: #1c1e21;
}
.modal-content label {
    margin-bottom: 5px;
    font-weight: 600;
    color: #333;
}
.modal-content input[type="text"],
.modal-content textarea {
    width: 100%;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
    resize: vertical;
}
.modal-content textarea {
    height: 80px;
}
.modal-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}
.modal-buttons button {
    padding: 10px 16px;
    font-weight: 600;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s;
}
.btn-cancel {
    background-color: #ccc;
    color: #333;
}
.btn-cancel:hover {
    background-color: #bbb;
}
.btn-add {
    background-color: #1877f2;
    color: #fff;
}
.btn-add:hover {
    background-color: #166fe5;
}
.btn-delete-confirm {
    background-color: #e74c3c;
    color: #fff;
}
.btn-delete-confirm:hover {
    background-color: #c0392b;
}
.error-msg {
    color: #e74c3c;
    font-weight: 600;
    margin-bottom: 15px;
    display: none;
}
.error-msg.show {
    display: block;
}
</style>
</head>
<body>

<header>
    <h1 class="main-title">FireReps Spreadsheet</h1>
    <form id="login-form">
        <input type="text" id="login" placeholder="login" required />
        <input type="password" id="password" placeholder="haslo" required />
        <button type="submit">zaloguj</button>
    </form>
    <button id="logout-btn">wyloguj</button>
</header>

<main id="item-container"></main>

<div class="add-card" id="add-card" title="dodaj nowy produkt">
    <div class="plus-icon">+</div>
    <h3>dodaj nowy produkt</h3>
</div>

<!-- modal dodawania -->
<div id="add-item-modal" class="modal">
    <div class="modal-content">
        <h2>dodaj nowy produkt</h2>
        <div class="error-msg" id="add-error"></div>
        <form id="add-item-form">
            <label for="item-name">nazwa produktu <span style="color:red">*</span></label>
            <input type="text" id="item-name" required />

            <label for="item-desc">opis produktu</label>
            <textarea id="item-desc"></textarea>

            <label for="item-link">link do produktu</label>
            <input type="text" id="item-link" placeholder="https://..." />

            <label for="item-image-url">url do zdjecia (opcjonalne)</label>
            <input type="text" id="item-image-url" placeholder="https://..." />

            <div class="modal-buttons">
                <button type="button" class="btn-cancel" id="cancel-add">anuluj</button>
                <button type="submit" class="btn-add">dodaj produkt</button>
            </div>
        </form>
    </div>
</div>

<!-- modal usuwania -->
<div id="delete-confirm-modal" class="modal">
    <div class="modal-content">
        <h2>czy na pewno chcesz usunac ten produkt?</h2>
        <div class="modal-buttons">
            <button class="btn-cancel" id="cancel-delete">nie</button>
            <button class="btn-delete-confirm" id="confirm-delete">tak</button>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js"></script>
<script>
const firebaseConfig = {
    apiKey: "AIzaSyB7tQvTVeG-WlBcvTByiKW7GfPpD52vDGw",
    authDomain: "spridszit-firerepy.firebaseapp.com",
    databaseURL: "https://spridszit-firerepy-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "spridszit-firerepy",
    storageBucket: "spridszit-firerepy.firebasestorage.app",
    messagingSenderId: "963006920352",
    appId: "1:963006920352:web:58538b879f004c02873bc5"
};
const app = firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const itemsRef = db.ref('items');

const itemContainer = document.getElementById('item-container');
const addCard = document.getElementById('add-card');
const addItemModal = document.getElementById('add-item-modal');
const addItemForm = document.getElementById('add-item-form');
const cancelAddBtn = document.getElementById('cancel-add');
const deleteConfirmModal = document.getElementById('delete-confirm-modal');
const cancelDeleteBtn = document.getElementById('cancel-delete');
const confirmDeleteBtn = document.getElementById('confirm-delete');
const loginForm = document.getElementById('login-form');
const logoutBtn = document.getElementById('logout-btn');

let deleteKey = null;
let isAdmin = false;

function openModal(modal) {
    modal.classList.add('show');
    document.body.classList.add('modal-open');
}
function closeModal(modal) {
    modal.classList.remove('show');
    document.body.classList.remove('modal-open');
}
function clearItems() {
    itemContainer.innerHTML = '';
}
function createItemCard(key, item) {
    const card = document.createElement('div');
    card.classList.add('item-card');

    const img = document.createElement('img');
    img.src = item.image;
    img.alt = item.name;
    card.appendChild(img);

    const content = document.createElement('div');
    content.classList.add('card-content');

    const title = document.createElement('h3');
    title.textContent = item.name;
    content.appendChild(title);

    const desc = document.createElement('p');
    desc.textContent = item.description || '';
    content.appendChild(desc);

    if(item.link) {
        const link = document.createElement('a');
        link.href = item.link;
        link.target = '_blank';
        link.rel = 'noopener noreferrer';
        link.textContent = 'kup produkt';
        link.classList.add('buy-btn');
        content.appendChild(link);
    }

    card.appendChild(content);

    if(isAdmin){
        const deleteBtn = document.createElement('button');
        deleteBtn.textContent = 'usun produkt';
        deleteBtn.classList.add('delete-btn', 'show');
        deleteBtn.addEventListener('click', () => {
            deleteKey = key;
            openModal(deleteConfirmModal);
        });
        card.appendChild(deleteBtn);
    }

    return card;
}
function refreshItems() {
    clearItems();
    itemsRef.once('value', (snapshot) => {
        clearItems();
        snapshot.forEach(childSnapshot => {
            const key = childSnapshot.key;
            const item = childSnapshot.val();
            const card = createItemCard(key, item);
            itemContainer.appendChild(card);
        });
    });
}

loginForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const login = document.getElementById('login').value.trim();
    const pass = document.getElementById('password').value.trim();
    if(login === 'ifirelovereps' && pass === 'fi123re987re098ps321'){
        isAdmin = true;
        addCard.classList.add('show');
        loginForm.style.display = 'none';
        logoutBtn.classList.add('show');
        refreshItems();
    } else {
        alert('bledny login lub haslo');
    }
});

logoutBtn.addEventListener('click', () => {
    isAdmin = false;
    addCard.classList.remove('show');
    loginForm.style.display = 'flex';
    logoutBtn.classList.remove('show');
    refreshItems();
});

addCard.addEventListener('click', () => {
    openModal(addItemModal);
});

cancelAddBtn.addEventListener('click', () => {
    addItemForm.reset();
    closeModal(addItemModal);
});

addItemForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = document.getElementById('item-name').value.trim();
    const desc = document.getElementById('item-desc').value.trim();
    const link = document.getElementById('item-link').value.trim();
    const imageUrl = document.getElementById('item-image-url').value.trim();

    if(!name){
        showAddError('nazwa produktu jest wymagana');
        return;
    }
    if(!imageUrl){
        showAddError('musisz podac url do zdjecia');
        return;
    }
    showAddError('');

    const newItem = {
        name,
        description: desc,
        link,
        image: imageUrl
    };
    itemsRef.push(newItem, (error) => {
        if(error){
            showAddError('blad dodawania produktu');
        } else {
            addItemForm.reset();
            closeModal(addItemModal);
            refreshItems();
        }
    });
});

function showAddError(msg) {
    const errorDiv = document.getElementById('add-error');
    if(msg){
        errorDiv.textContent = msg;
        errorDiv.classList.add('show');
    } else {
        errorDiv.textContent = '';
        errorDiv.classList.remove('show');
    }
}

cancelDeleteBtn.addEventListener('click', () => {
    deleteKey = null;
    closeModal(deleteConfirmModal);
});

confirmDeleteBtn.addEventListener('click', () => {
    if(deleteKey){
        itemsRef.child(deleteKey).remove((error) => {
            if(error){
                alert('blad usuwania');
            } else {
                deleteKey = null;
                closeModal(deleteConfirmModal);
                refreshItems();
            }
        });
    }
});

refreshItems();
</script>

</body>
</html>
